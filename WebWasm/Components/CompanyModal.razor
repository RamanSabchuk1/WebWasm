@using WebWasm.Models

@if (IsOpen)
{
	<div class="modal-overlay" @onclick="CloseModal">
		<div class="modal-container modal-large" @onclick:stopPropagation="true">
			<div class="modal-header">
				<h2>Add New Company</h2>
				<button class="btn-close" @onclick="CloseModal">√ó</button>
			</div>

			<div class="modal-body">
				<!-- Company Details Section -->
				<div class="form-section">
					<h3>Company Details</h3>
					<div class="form-row">
						<div class="form-group">
							<label>Legal Name *</label>
							<input type="text"
								   class="form-control"
								   @bind="_legalName"
								   placeholder="Enter legal company name" />
						</div>

						<div class="form-group">
							<label>UNP *</label>
							<input type="text"
								   class="form-control"
								   @bind="_unp"
								   placeholder="Enter UNP" />
						</div>
					</div>

					<div class="form-group">
						<label>Legal Address *</label>
						<input type="text"
							   class="form-control"
							   @bind="_legalAddress"
							   placeholder="Enter legal address" />
					</div>

					<div class="form-row">
						<div class="form-group">
							<label>Corporate Email *</label>
							<input type="email"
								   class="form-control"
								   @bind="_corporateEmail"
								   placeholder="company@example.com" />
						</div>

						<div class="form-group">
							<label>Legal Type *</label>
							<input type="text"
								   class="form-control"
								   @bind="_legalType"
								   placeholder="e.g., LLC, JSC, etc." />
						</div>
					</div>
				</div>

				<!-- Bank Account Section -->
				<div class="form-section">
					<h3>Bank Account</h3>
					<div class="form-row">
						<div class="form-group">
							<label>Bank Number *</label>
							<input type="text"
								   class="form-control"
								   @bind="_bankNumber"
								   placeholder="Enter bank account number" />
						</div>

						<div class="form-group">
							<label>BIC *</label>
							<input type="text"
								   class="form-control"
								   @bind="_bic"
								   placeholder="Enter BIC code" />
						</div>
					</div>
				</div>

				<!-- Operational Info Section -->
				<div class="form-section">
					<h3>Operational Information</h3>
					<div class="form-row">
						<div class="form-group">
							<label>Start Working Hours *</label>
							<input type="time"
								   class="form-control"
								   @bind="_startWorkingHours" />
						</div>

						<div class="form-group">
							<label>End Working Hours *</label>
							<input type="time"
								   class="form-control"
								   @bind="_endWorkingHours" />
						</div>
					</div>

					<div class="form-group">
						<label>Photo URL</label>
						<input type="text"
							   class="form-control"
							   @bind="_photo"
							   placeholder="Enter company photo URL (optional)" />
						@if (!string.IsNullOrEmpty(_photo))
						{
							<div class="photo-preview">
								<img src="@_photo" alt="Company preview" />
							</div>
						}
					</div>

					<div class="form-group">
						<label>Location *</label>
						<LocationMapPicker @ref="_locationPicker"
										   InitialLocation="@_location"
										   OnLocationChanged="HandleLocationChanged" />
					</div>
				</div>

				<!-- Contact Phones Section -->
				<div class="form-section">
					<h3>Contact Phones</h3>
					<div class="phone-input-group">
						<input type="tel"
							   class="form-control"
							   @bind="_newPhone"
							   @onkeypress="@(e => { if (e.Key == "Enter") AddPhone(); })"
							   placeholder="Enter phone number" />
						<button type="button" class="btn-add-phone" @onclick="AddPhone">
							+ Add
						</button>
					</div>

					@if (_contactPhones.Count > 0)
					{
						<div class="phones-list">
							@for (int i = 0; i < _contactPhones.Count; i++)
							{
								var phone = _contactPhones[i];
								var index = i;
								<div class="phone-item">
									<span class="phone-number">üìû @phone</span>
									<button type="button" class="btn-remove-phone" @onclick="() => RemovePhone(index)">
										üóëÔ∏è
									</button>
								</div>
							}
						</div>
					}
					else
					{
						<p class="no-phones">No contact phones added yet</p>
					}
				</div>

				@if (!string.IsNullOrEmpty(_errorMessage))
				{
					<div class="error-message">
						‚ö†Ô∏è @_errorMessage
					</div>
				}
			</div>

			<div class="modal-footer">
				<button class="btn-secondary" @onclick="CloseModal">Cancel</button>
				<button class="btn-primary" @onclick="HandleSubmit" disabled="@(!IsValid)">
					Create Company
				</button>
			</div>
		</div>
	</div>
}
