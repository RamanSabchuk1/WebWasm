@using WebWasm.Models

@if (IsOpen)
{
	<div class="modal-overlay" @onclick="CloseModal">
		<div class="modal-container" @onclick:stopPropagation="true">
			<div class="modal-header">
				<h2>@(IsEditMode ? "Edit Material" : "Add New Material")</h2>
				<button class="btn-close" @onclick="CloseModal">×</button>
			</div>

			<div class="modal-body">
				<div class="form-group">
					<label>Name *</label>
					<input type="text" 
						   class="form-control" 
						   @bind="_name" 
						   placeholder="Enter material name" />
				</div>

				<div class="form-group">
					<label>Description *</label>
					<textarea class="form-control" 
							  @bind="_description" 
							  rows="3"
							  placeholder="Enter material description"></textarea>
				</div>

				<div class="form-group">
					<label>Solidity *</label>
					<input type="text" 
						   class="form-control" 
						   @bind="_solidity" 
						   placeholder="Enter solidity level" />
				</div>

				<div class="form-group">
					<label>Photo URL</label>
					<input type="text" 
						   class="form-control" 
						   @bind="_photo" 
						   placeholder="Enter photo URL (optional)" />
					@if (!string.IsNullOrEmpty(_photo))
					{
						<div class="photo-preview">
							<img src="@_photo" alt="Preview" />
						</div>
					}
				</div>

				@if (CanSetParent)
				{
					<div class="form-group">
						<label>Parent Material</label>
						<select class="form-control" @bind="_parentId">
							<option value="">None (Root Material)</option>
							@foreach (var material in AvailableMaterials)
							{
								<option value="@material.Id">@material.Name</option>
							}
						</select>
						<small class="form-help">Only root materials can be selected as parent</small>
					</div>
				}
				else
				{
					<div class="form-info">
						ℹ️ Root materials cannot be converted to child materials
					</div>
				}

				@if (!string.IsNullOrEmpty(_errorMessage))
				{
					<div class="error-message">
						⚠️ @_errorMessage
					</div>
				}
			</div>

			<div class="modal-footer">
				<button class="btn-secondary" @onclick="CloseModal">Cancel</button>
				<button class="btn-primary" @onclick="HandleSubmit" disabled="@(!IsValid)">
					@(IsEditMode ? "Update" : "Create")
				</button>
			</div>
		</div>
	</div>
}
