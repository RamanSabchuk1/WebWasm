@inject LocalStorageAuthStateProvider AuthProvider

@if (!IsMobile)
{
    <!-- Desktop Sidebar Navigation -->
    <div class="desktop-nav">
        <div class="nav-header">
            <div class="logo-container">
                <span class="logo-icon">⚡</span>
                <span class="logo-text">Admin Panel</span>
            </div>
            <NavLink href="myuserinfo">
                <div class="user-profile">
                    <div class="avatar">👤</div>
                    <span class="status-badge online">online</span>
                </div>
            </NavLink>
        </div>

        <div class="nav-section">
            <span class="nav-section-title">Main</span>
            <nav class="nav-list">
                <NavLink class="nav-item" href="" Match="NavLinkMatch.All">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </NavLink>
                <NavLink class="nav-item" href="orders">
                    <span class="nav-icon">📦</span>
                    <span class="nav-text">Orders</span>
                </NavLink>
                <NavLink class="nav-item" href="users">
                    <span class="nav-icon">👥</span>
                    <span class="nav-text">Users</span>
                </NavLink>
                <NavLink class="nav-item" href="companies">
                    <span class="nav-icon">🏢</span>
                    <span class="nav-text">Companies</span>
                </NavLink>
            </nav>
        </div>

        <div class="nav-section">
            <span class="nav-section-title">Management</span>
            <nav class="nav-list">
                <NavLink class="nav-item" href="providers">
                    <span class="nav-icon">🔗</span>
                    <span class="nav-text">Providers</span>
                </NavLink>
                <NavLink class="nav-item" href="vehicles">
                    <span class="nav-icon">🚗</span>
                    <span class="nav-text">Vehicles</span>
                </NavLink>
                <NavLink class="nav-item" href="payments">
                    <span class="nav-icon">💳</span>
                    <span class="nav-text">Payments</span>
                </NavLink>
            </nav>
        </div>

        <div class="nav-section">
            <span class="nav-section-title">Base</span>
            <nav class="nav-list">
                <NavLink class="nav-item" href="regions">
                    <span class="nav-icon">🗺️</span>
                    <span class="nav-text">Regions</span>
                </NavLink>
                <NavLink class="nav-item" href="materials">
                    <span class="nav-icon">📋</span>
                    <span class="nav-text">Materials</span>
                </NavLink>
                <NavLink class="nav-item" href="devices">
                    <span class="nav-icon">📱</span>
                    <span class="nav-text">Devices</span>
                </NavLink>
                <NavLink class="nav-item" href="supports">
                    <span class="nav-icon">🎧</span>
                    <span class="nav-text">Support</span>
                </NavLink>
            </nav>
        </div>

        <div class="nav-footer">
            <button class="logout-btn" @onclick="Logout">
                <span class="nav-icon">🚪</span>
                <span class="nav-text">Log Out</span>
            </button>
        </div>
    </div>
}
else
{
    <!-- Mobile Bottom Navigation (Icons only, no labels) -->
    <div class="mobile-nav-bar">
        <NavLink class="mobile-nav-item" href="" Match="NavLinkMatch.All">
            <span class="mobile-nav-icon">🏠</span>
        </NavLink>
        <NavLink class="mobile-nav-item" href="orders">
            <span class="mobile-nav-icon">📦</span>
        </NavLink>
        <NavLink class="mobile-nav-item" href="users">
            <span class="mobile-nav-icon">👥</span>
        </NavLink>
        <button class="mobile-nav-item menu-trigger" @onclick="ToggleNavMenu">
            <span class="mobile-nav-icon">☰</span>
        </button>
    </div>

    @if (!collapseNavMenu)
    {
        <div class="mobile-menu-overlay" @onclick="ToggleNavMenu">
            <div class="mobile-menu-panel" @onclick:stopPropagation>
                <div class="mobile-menu-header">
                    <span class="mobile-menu-title">Menu</span>
                    <button class="close-btn" @onclick="ToggleNavMenu">✕</button>
                </div>
                <nav class="mobile-menu-list">
                    <NavLink class="mobile-menu-item" href="companies" @onclick="ToggleNavMenu">
                        <span class="nav-icon">🏢</span> Companies
                    </NavLink>
                    <NavLink class="mobile-menu-item" href="regions" @onclick="ToggleNavMenu">
                        <span class="nav-icon">🗺️</span> Regions
                    </NavLink>
                    <NavLink class="mobile-menu-item" href="devices" @onclick="ToggleNavMenu">
                        <span class="nav-icon">📱</span> Devices
                    </NavLink>
                    <NavLink class="mobile-menu-item" href="providers" @onclick="ToggleNavMenu">
                        <span class="nav-icon">🔗</span> Providers
                    </NavLink>
                    <NavLink class="mobile-menu-item" href="materials" @onclick="ToggleNavMenu">
                        <span class="nav-icon">📋</span> Materials
                    </NavLink>
                    <NavLink class="mobile-menu-item" href="payments" @onclick="ToggleNavMenu">
                        <span class="nav-icon">💳</span> Payments
                    </NavLink>
                    <NavLink class="mobile-menu-item" href="vehicles" @onclick="ToggleNavMenu">
                        <span class="nav-icon">🚗</span> Vehicles
                    </NavLink>
                    <NavLink class="mobile-menu-item" href="supports" @onclick="ToggleNavMenu">
                        <span class="nav-icon">🎧</span> Support
                    </NavLink>
                </nav>
                <button class="mobile-logout-btn" @onclick="Logout">
                    <span class="nav-icon">🚪</span> Log Out
                </button>
            </div>
        </div>
    }
}

@code {
    [Parameter]
    public bool IsMobile { get; set; } = false;

    private bool collapseNavMenu = true;

    private string? NavMenuCssClass => collapseNavMenu ? "collapse" : null;

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

    private async Task Logout()
    {
        await AuthProvider.MarkUserAsLoggedOut();
    }
}
